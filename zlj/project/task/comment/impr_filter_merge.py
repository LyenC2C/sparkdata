#coding:utf-8
__author__ = 'zlj'
import sys

reload(sys)
sys.setdefaultencoding('utf8')

from pyspark import *
from pyspark.sql import *



conf = SparkConf()
conf.set("spark.hadoop.validateOutputSpecs", "false")
sc = SparkContext(appName="cmt",conf=conf)
sqlContext = SQLContext(sc)
hiveContext = HiveContext(sc)
'''
错误标签过滤 以及 相似标签合并
'''

'''
卖家服务 :热情 周到 耐心  解答 回答  讲解  细心 有问必答  服务

---服务好

物流   :快  很快  速度  神速

质量:  好  很好 不错  挺好

商品:  好 很好  不错

价格： 棒 好

'''

from collections import defaultdict

f_map = defaultdict(set)
f_map['good'].union([i.strip().decode('utf-8') for  i in '好  很好 不错  挺好  棒'.split()])
f_map['wuliu'].union([i.strip().decode('utf-8') for  i in '快  很快  速度  神速'.split()])
f_map['fuwu'].union([i.strip().decode('utf-8') for  i in '热情 周到 耐心  解答 回答  讲解  细心 有问必答  服务'.split()])

def merge(k,v):
    if v in f_map['good']:
        v='好'
    if v in f_map['wuliu']:#如果是物流的数据 直接返回物流
        k='物流'
        v='快'
    if v in  f_map['taidu'] or k in f_map['taidu']:
        k='服务'
        v='好'
    return k,v


def getfield(x):
    lv=x.split()
    rs=[]
    ls=[]
    if len(lv)!=5: return None
    else:
        item_id,feed_id,user_id,feed,impr=lv
        neg=1 #默认好评

        for i in impr.split('|'):
            ts=i.split(',')
            flag,scores=pos_neg(ts[0])
            ls.append(i+'_'+scores)
            neg+=flag
            if ":" in i:
                k,v=ts[-1].split(':')
                k1,v1=merge(k,v)
                rs.append(k1+":"+v1)
    return [item_id,feed_id,user_id,feed,'|'.join(ls),str(neg),'|'.join(rs)]
    # return feed+'\t'+'|'.join(ls)

def valid_jsontxt(content):
    if type(content) == type(u""):
        return content.encode("utf-8")
    else :
        return content

def f_coding(x):
    if type(x) == type(""):
        return x.decode("utf-8")
    else:
        return x

neg_line="不是 不太 不能 不可以 没有 沒有 木有 没 未 别 莫 勿 不够 不必 甭 不曾 不怎么 不如 无 不是 并未 不太 绝不 谈不上 看不出 达不到 并非 从不 从没 毫不 不肯 有待 无法 没法 毫无 没有什么 没什么"
pos_emo_line="实惠 热情 刚刚好 很快解决 大爱 超爱 一流 没鸭梨 还行 改善 对得起 敬业 相当 也好 好闻 全棉 不同凡响 符合 合口味 合理合法 合情 超出期望 合情合理 名不虚传 上乘 受宠若惊 舒舒服服 优质 与众不同 支持 拉风 friendly 爱国 爱美 安定 安分 安好 安和 安静 安康 安乐 安宁 安全 安详 安心 安逸 暗喜 奥妙 霸气 白嫩 般配 板实 板正 棒 再接再厉 保暖 保温 保险 饱满 宝贵 悲壮 本分 逼真 便捷 便利 别致 博大 不错 部错 8错 不拘小节 不俗 不易 灿烂 苍劲 昌盛 长青 长寿 长远 长足 敞亮 畅 畅快 畅顺 畅通 畅销 超前 超软 超赞 潮 沉静 沉稳 称心 称意 赞一个 称职 橙白 成功 诚 诚诚恳恳 诚恳 诚实 诚挚 持续不断 赤诚 充沛 充实 充裕 崇高 出名 出色 出众 传神 醇厚 淳朴 纯 纯洁 纯净 纯美 纯情 纯一 纯真 纯正 慈悲 慈善 慈祥 瓷实 聪慧 聪明 从容 粗旷 粗犷 大度 大方 大好 大吉 大气 带劲 单纯 淡定 淡漠 淡雅 道德 得当 得力 得人心 得体 低廉 地道 典型 典雅 顶 顶事 顶用 懂事 懂行 动人 动听 逗人 独到 独立 端正 端庄 对劲 对口 对路 对味 敦厚 敦实 夺目 恩爱 发达 繁荣 方便 方正 费心 丰富 丰厚 丰满 丰盛 锋利 风光 风趣 伏贴 服帖 负责 富贵 富强 富裕 概括 干净 干练 干爽 甘甜 感动 感人 刚好 刚健 刚劲 刚硬 高昂 高超 高贵 高级 高亮 高明 高强 高尚 高深 高新 高兴 高雅 革命 各别 给力 耿直 梗直 工整 恭敬 公道 公平 公允 公正 够格 够劲 够朋友 骨感 乖 乖巧 管用 光彩 光滑 光辉 光火 光洁 光亮 光明 光荣 光润 光艳 广博 广阔 规范 规矩 果断 过得硬 过硬 过瘾 害羞 憨厚 憨实 含蓄 豪放 豪华 豪迈 豪爽 豪壮 好 好吃 好德 好看 好客 好评 好受 好听 好玩 好玩儿 好心 好学 好用 好走 浩大 和蔼 和美 和睦 和气 和善 和谐 合度 合法 合脚 合理 合拍 合身 合适 合体 合意 恒久 洪亮 宏亮 宏伟 红火 厚道 华贵 华丽 华美 欢 很正 欢快 欢乐 欢欣 欢愉 缓和 惶恐 辉煌 浑厚 豁达 豁亮 活络 活泼 活跃 火辣 机动 机灵 机智 积极 激动 激扬 吉利 及时 急进 佳 坚定 坚韧 坚实 坚挺 坚硬 尖利 简便 简捷 简洁 简略 简明 赞不绝口 质优价廉 简朴 简省 简要 简易 简约 俭省 健康 健谈 健旺 讲究 讲理 娇嫩 娇小 娇艳 矫情 节俭 杰出 洁净 结实 金贵 紧密 紧俏 紧要 紧张 紧致 谨慎 进步 尽心 尽责 劲爆 惊诧 惊喜 惊艳 惊疑 精 精辟 精彩 精到 精典 精干 精悍 精炼 精练 精良 精美 精密 精妙 精巧 精确 精锐 精神 精通 精细 精心 精湛 精致 精准 经典 经济 经心 经意 静 静谧 具体 决绝 绝佳 绝美 绝情 均衡 俊 开放 开阔 开朗 开明 开窍 开胃 开心 慷慨 亢奋 考究 靠得住 科学 可爱 可观 可贵 可嘉 可敬 可靠 可口 可乐 可亲 可取 可人 可喜 可心 可信 可行 可依 可以 可意 客气 恳切 快活 快乐 快慰 宽敞 宽宏 宽心 宽余 宽裕 阔气 浪漫 牢 牢靠 老实 乐观 乐呵 乐意 类似 冷静 冷艳 冷幽默 理想 理智 礼貌 利落 利索 俐落 连贯 凉快 凉爽 良好 亮 亮丽 亮堂 凛冽 玲珑 伶俐 灵 灵便 灵光 灵活 灵敏 灵巧 灵通 灵秀 灵验 流畅 流利 隆重 率真 麻利 卖力 满足 美 美观 美好 美丽 美满 美妙 美艳 猛烈 迷人 密致 苗条 妙 妙极 民主 敏捷 敏锐 明白 明澈 明净 明快 明朗 明理 明丽 明亮 明媚 明晰 明细 明显 明艳 明智 摩登 默契 拿手 耐久 耐磨 耐心 耐用 难得 好极了 棒极了 难忘 内敛 内行 能干 年轻 念旧 浓厚 浓郁 女人味 暖和 暖心 配套 蓬勃 皮实 飘逸 漂亮 平安 平等 平凡 平滑 略逊一筹 平缓 平实 平顺 平稳 平易 平整 平直 迫切 朴实 朴素 普及 欺生 奇妙 齐 齐备 齐全 齐整 起眼 气派 恰当 前卫 强 强大 强劲 强强 强盛 抢手 抢眼 巧妙 俏 俏丽 俏皮 切实 亲密 亲切 勤奋 勤俭 勤勉 轻薄 轻便 轻快 轻灵 轻飘 轻巧 轻松 轻盈 清白 清澈 清楚 清纯 清和 清洁 清静 清净 清凉 清亮 清浅 清爽 清晰 清闲 清新 清心 清醒 清秀 清雅 清远 晴好 晴朗 权威 全 缺德 确切 确凿 惹火 热忱 热诚 热乎 热火 热辣 热烈 热切 认真 荣幸 荣耀 融洽 柔 柔和 柔美 柔软 柔顺 肉感 如意 入迷 入神 入时 入眼 软和 锐利 润 洒脱 煽情 上佳 上进 上口 上算 上心 奢华 深刻 深切 深通 神奇 神气 神圣 神似 神勇 慎重 生动 呱呱叫 省电 省力 省料 省时 省事 省心 圣洁 湿润 时新 时髦 实时 实心 实用 实在 适当 适度 适口 适量 适时 适用 适中 手巧 守信 受宠 受看 受用 舒畅 舒服 舒适 舒坦 属实 帅 帅哥哥 帅气 爽脆 爽滑 爽口 爽快 爽朗 爽利 爽气 爽心 爽直 水灵 顺畅 顺当 顺耳 顺滑 顺口 顺利 顺手 顺心 顺眼 斯文 松软 素净 素雅 塑身 随心 塌实 塌心 踏实 太平 坦白 坦然 讨喜 体面 甜 甜美 甜蜜 贴切 贴身 贴心 听话 挺拔 挺好 通畅 通顺 通透 统一 痛快 投缘 透彻 团结 妥 妥当 妥善 妥帖 外向 顽强 完备 完美 完善 完整 婉约 婉转 旺 威猛 微妙 唯美 委婉 伟大 味美 卫生 温和 温暖 温柔 温顺 温文 温馨 文静 文明 文雅 稳 稳当 稳定 稳固 稳健 稳妥 稳重 无尘 无华 稀缺 稀少 稀松 希罕 希奇 犀利 喜爱 喜出望外 喜庆 喜人 喜悦 系统 细白 细滑 细密 细腻 细心 细致 先进 鲜亮 鲜美 鲜明 鲜艳 纤巧 纤细 贤惠 贤淑 显明 显瘦 显要 现实 相称 相似 相同 相像 香 香浓 祥和 详尽 详实 详细 响亮 萧洒 销魂 小鸟依人 小巧 小心 孝顺 协调 谐调 辛劳 辛勤 新 新式 新鲜 新异 新颖 心安 心切 心善 中规中矩 兴奋 兴隆 兴盛 兴旺 行 醒目 幸福 幸甚 幸运 性感 雄厚 雄伟 修长 修身 秀丽 秀美 秀气 玄 绚烂 绚丽 迅捷 迅速 雅观 雅致 严紧 严谨 严密 严明 严整 严正 艳丽 洋气 阳刚 遥远 耀眼 宜人 易懂 易学 殷切 英俊 英明 英勇 硬气 硬实 踊跃 勇敢 用功 幽静 优厚 优美 优秀 优雅 优异 优越 悠久 悠然 悠扬 有度 有节 有劲 有利 有力 有名 有神 有效 有型 有序 有眼力 有益 有用 诱人 愉快 愉悦 原单 圆满 圆润 远大 悦耳 悦目 匀 匀称 在理 在行 攒劲 扎实 崭新 站得住 仗义 珍贵 珍稀 真 真切 真实 真挚 整洁 整齐 正 正常 正当 正规 正经 正派 正确 正统 知名 知心 直白 直观 直率 直爽 执著 执着 质朴 滞涩 中看 中肯 中听 中意 中用 中正 忠诚 忠厚 忠实 终级 杠杠 高科技 焕然一新 人性化 量身定做 震撼 方便快捷 重大 重要 周到 周密 周全 周详 主动 专心 专业 专一 壮观 壮实 准 准确 准时 卓越 茁壮 仔细 自得 自豪 自觉 自然 自在 自重 走运 最大 最美 尊贵 尊严 倜傥 诙谐 啧啧称赞 嘹亮 怡人 惬意 潇洒 娴熟 缜密 炫酷 睿智 虔诚 靓丽 显身材 酷酷的 很棒 爱死了 爱死 喜欢死了 真材实料 没的说 没得说 到位 吻合 稀饭 守信用 不含糊 魅惑 好好 好销 容易 严实 合适 时尚 合适 正合适 漂亮 好看 码很正 码正 喜欢 柔软 愉快 透气 厚实 纯棉 舒服 细致 bucuo hao haoping haixing haikeyi ok sexy abide abided abides abiding ability abound abounded abounding abounds abundance abundant abundantly accede acceded accedes acceding accept acceptability acceptable acceptableness acceptably acceptance accepted accepting accepts accessibility accessible accessibleness accessibly accession acclaim acclaimed acclaiming acclaims acclamation accolade accoladed accolades accolading accompaniment accompaniments accomplish accomplished accomplishes accomplishing accomplishment accomplishments accord accordance accorded accords accountability accountable accountableness accountably accrue accrued accrues accruing accuracy accurate accurately accurateness achieve achieved achievement achieves achieving acknowledgement acquaint acquaintance acquainted acquainting acquaints actual actuality adaptability adaptable adaptableness adaptably adaptation adaptive adaptively adaptiveness adept adeptly adeptness adequate adherence adherent adhesion adhesive adhesiveness adhesivly admirability admirable admirableness admirably admiration admire admired admirer admirers admires admiring admit admits admittance admitted admitting adorability adorable adorableness adorably adore adorn adornment adroit adroitly advance advancement advantage advantageous advent adventuresome adventurous advisable advocacy affability affable affection affectionate affinity affirm affirmation affirmative affluence affluent agile agility agreeable agreement aid alertness alight alive allegiance alleviate alliance allied allies allow allowable allowance allure ally almighty altruistic amazement amazing ameliorate amenable amenity amiability amiable amicable amnesty ample amplify amply amuse amused amusement amuses amusing angel angelic apocalypse appease applaud applause appoint appreciable appreciate appreciation appreciative apprehend appropriate approval approve apt aptitude arbiter ardent arisen aristocracy aristocrat aristocratic art aspiration aspire assent assertion assist assistance assistant assurance assure assuredly athletic attachment attain attainment attentive attract attraction attractive attractiveness attune auspicious authentic authenticity authoritative authority availability available award backbone backer backing balmy beauteous beautiful beautifully beautify beauty befit befitting befriend believable believe believed believes believing beloved benefactor beneficent beneficial beneficiary benefit benefited benefiting benefits benefitted benefitting benefitts benevolence benevolent benign bequeath best bestow better blameless bliss blissful blithe boldness bonny bonus boom boost boundless bountiful brainy brave bravery breadwinner bright brightness brilliance brilliant brotherhood brotherly buoyant calm calmness candid candor capability capable capitalize captivation carefree careful caress ceaseless celebrate celebration celebrity ceremonial champ champion charisma charitable charity charm chaste cheer cheerful cheery cherish cherub chic chivalrous chivalry chum civil civility civilization civilize clarify clarity classic clean cleanliness cleanse clear clearness clever closeness clout co-operation coax coddle coexistence cogent cognizance cognizant coherent cohesion cohort coincident collaborate collaboration colleague colossal comeback comedy comely comestible comfort comfortable comic comical commemorate commemoration commencement commend commendable commendation commensurate commission commitment commodious commonsense companionship compatible compensate compensation competence competency competent complement complementary completion compliance compliment composure comprehend comprehension comprehensive compromise concession conclusive concur condone conducive confederation confer confidant confide confidence confident congenial congratulate congratulation congratulatory congregate conjunction conjure conquer conqueror conquest conscience conscientious consensus consent conserve considerate consideration consign consistency consistent consolidate constancy constructive consult consultation consummate contentment continuity contribute contribution contributor convene conviction convince convinced convinces convincing cooperate cooperation cooperative coordinate coordination cordial correct correction council counsel courage courageous courteous courtesy courtly covenant cozy creative creativity credentials credibility credible credit crusade crusader cuddle culminate culmination cultivate cultivation cupid cure curtsey cute dance daring darling dauntless dawn dazzle dear decency decent decipher decorate decoration decorative dedicate dedication deduce deference definitive delicacy delicate delight delighted delightful delighting delights dependability dependable descry deserve deservedly desirable desirous devote devotion devout dexterity dignified dignify dignity diligent discern discreet discretion distinct distinction distinctive distinguish distinguished divine divinity dominance donate donation dote doubtless dreamland durability durable dynamic eager eagerness earnest earnestness ease easy economize ecstasy ecstatic edible effective effectively effectiveness efficacy efficiency efficient elaborate elaboration elate elegance elegant eloquent embellish embrace eminence eminent empathy empower empowerment enable enchant enchantment encourage encouragement endear endorse endow endurance energetic energize engage enhance enhancement enjoy enjoyable enjoyed enjoying enjoyment enjoys enlighten enlightenment enrich enrichment ensemble ensure entertain entertainment enthusiasm enthusiastic entrepreneurial entrust envision equality equitable equity essential establish esteem ethical everlasting exact exalt excel excellence excellent excite excited excitedness excitement exertion exhilaration exotic experienced expert exquisite extol extraordinary extravagance exuberance exuberant exult exultation fabulous facilitate factual fair fairness faithful faithfulness fame familiar familiarity familiarize famous fancy fantastic fantasy farsighted fascinate fascinated fascinates fascinating fascination fashionable favor favorable favorableness favorably favored favoring favoring favoringly favorite favors fearless feasible feast fellowship fertile fervent fervor festival festive festivity fidelity fiery filial fill fine firmness fit fitness flair flashy flatter flattery flaunt flawless flexible flirt flourish fluent fond fondness foremost foresight forgave forgive forgiven forgiveness formality fortify fortitude fortunate foster fragrant frank free freedom fresh friendliness friendly friendship frolic frugal fruitful fruition fulfill fulfillment fun funny gaiety gaily gain gallant gallantry garnish generate generosity generous genial genius gentle genuine giddy gift gifted glad gladden gladness glamorous glamour gleam glean glee glimmer glisten glitter glorify glorious glory glossy glow godlike godliness gold golden good goodbye goodness gorgeous grace graceful gracious graduation grand grandeur grateful gratification gratify gratitude great greatness greet groom guarantee guardian gusto hallowed handsome handy happily happiness happy hardy harmless harmonious harmonize harmony harness hateless heal health healthful healthy heartily heavenly help helped helpful helping helps hero heroic heroine heroism highlight hilarious holy homage honest honeymoon honor honorable hopeful hospitable hug humanitarian humanity humility humor humorous hygiene ideal idealism idol idolize illuminate illustrious imagination imaginative immaculate immortal impartial impartiality imperative impervious impetus importance important impress impressive improve improved improvement improves improving impunity inaugurate inauguration independence independent indescribable indicative indispensability indispensable indomitable indulgence industrious inexpensive infallibility infallible infer inference inform informative ingenious ingenuity inherit innocence innocent innovate innovative inquisitive inseparable insight insightful insightfully insistent inspiration inspirational inspire instinctive integrity intellect intellectual intelligence intelligent intelligible intercede intercourse interest interested interesting interests interpose intimacy intimate intricate intrigue invaluable inventor invincible invitation invite invulnerable irresistible jest joke jolly joy joyful jubilant jubilee justice justifiably justification justify keen kind/jj kindness kiss laudable laugh laughed laughing laughs laughter lavish lawful legal legitimacy legitimate leisure liberal liberalism liberate liberty lifelong likable like/vb liked/vb likes/vb liking/vb lively logical longevity love/vb loved/vb loveliness lovely lover loves/vb loving/vb loyal loyalty lucid luck luckily lucky lucrative luminous lust luster lustrous luxuriant luxurious luxury lyric lyrical magical magnetic magnificence magnificent majestic majesty manageable manly marital marriage marry marvel marvelous masterful mastery matchless mate mature maturity maximize meaningful measurable mediate meditation mellow melody memorable mend mentor merciful mercy merit meritorious merrily merriment merry mesh meticulous mighty mild mindful minister mint miracle miraculous mirth mobility mobilize moderate moderation modernity modest modesty momentous monumental moral morale moralistic morality motivate motivated motivation motive myriad natural navigable neat necessarily negotiate nice niche nimble nobility noble nobleman noiseless nominate non-violence non-violent notable notoriety nourish nourishment novelty nurse nurture nutrient oasis obedience obedient obey oblige obtain obtainable offset onset onward open opportune opportunity optimal optimism optimistic organize originality outgoing outlive outrun outset outstanding outwit overcome overjoyed painstaking palatable palatial pamper paradise paramount pardon partner partnership pass passionate patient patriot patriotic patron patronage peace peaceable peaceful peerless perfect perfection perfectionism perfectionist perfume permission permit perseverance persevere persuasive pertinent picturesque piety pinnacle pious plain plausibility playful playmate plaything pleasant pleasantry pleased pleasurable pleasure pledge plentiful plenty polish polite politeness pomp popular popularity populous portable posterity potency potent powerful practicable practical praise prance precaution precedent precept precious precise precisely precision preeminent preference premier premise premium preparatory prestige prettily pretty priceless pride primarily prime principal principle privacy privileged privy prize pro proactive prodigious prodigy productive productivity profess proffer proficient profit profitable profound progress progressive prolific prominence prominent prominently promise prompt promptly proper propitious proprietary propriety prosecute prosper prosperity prosperous protect protection protective protector proud prowess prudence prudent punctual pure purification purify purity purposeful purr quaint qualify quench quick quicken quickly radiance radiant radiate rally rapport rapt rapture rational rave readily reap reasonable reassurance reassure receptive reclaim recline recommend recommendable recommended recommending recommends recompense reconcile reconciliation recreation redeem redemption reestablish refine refinement refuge regal regard rehabilitation reinforcement reinstate rejoice relax relaxation relaxed relaxes relaxing relevance relevancy relevant reliability reliable relief relieve religious relish remarkable remarkably remedy remodel renaissance renewal renovate renovation renown repair reparation repent repentance repose reputable resolute resolve resolved resound resourceful resourcefulness respect respectable respectably respected respectful respectfully respecting respects respite resplendent responsibility responsible responsive restful restoration restore resurrect reunion reunite revel revere reverence reverent reverently revitalize revival revive reward rich riches richness right righteous righteousness rightful ripe ripen robust romantic romanticize rosy round rouse sacred safe safeguard safety sagacity sage saint salutary salutation salute salvation sanctify sanctuary sane sanguine sanitary sanity satisfaction satisfactorily satisfactory satisfied satisfies satisfy satisfying save saved saves saving savings savor savvy scamper scruples scrupulous secure security selective self-contained self-respect semblance sensational sensible serene seriousness settle share shared shares sharing shelter shield shiny shrewd shrewdness significance significant signify simplicity simplify sincere sincerity skill skillful sleek smart smile smitten sober sociable softness solace solution soothe sophisticated sought soundness spare sparkle special spectacular speedily splendid splendor spotless sprightly squarely stability stabilize stable standardize staple stately statuesque staunch staunchness steadfast steadfastness steadiness steady stimulate stimulation straight straightforward strut stud studious stupendous sturdy stylish suave sublime subscribe subscription subsidize subsidy subsist subsistence substantiate succeed succeeded succeeding succeeds success successful successfully suffice sufficient suit suitable summit sumptuous super superior superiority superlative supportive supreme surge surmise surmount surpass survival survive survivor suspectless sweet sweeten sweetheart sweetness swiftness swoon sworn symbolize symmetry sympathetic sympathize sympathy synthesis tact talent talented temperance temperate tempt tenacious tenacity tenderness terrific thank thankful thankfully thankfulness thanks therapeutic thoughtful thrift thrifty thrive tingle tolerance tolerant tolerate toleration topmost tranquil tranquility treasure treaty tremendous tribute triumph triumphal triumphant trophy trust trustworthiness trustworthy truthful unbound unbroken uncommon undoubted undoubtedly unforgettable unhurried unimpeachable unique unity unlimited unpainful unpainfully unpainfulness unselfish unsuspect unsuspected unsuspecting unsuspectingly unsuspects untouched upbeat upfront upgrade upheld uphold uplift uppermost upright upside upward usable usably useful usefully usefulness utilitarian utilization utilize uttermost valiant valid validity valor valuable value vanquish vastness venerable venerate verification verify veritable versatile versatility viability viable victorious vigilance vigilant virtue virtuous visionary visualization vitality vivacious vivid voluntary vouchsafe warm warmhearted warmth wasteless welcome welfare well whimsical wholesome willing willingness wisdom wise witty wonderful wondrous woo workable workmanship world-famous worthiness worthy zenith zest 适合 值得 值 人性化 上档次 显档次 有档次 对的 无可挑剔 应有尽有 磨砂 烤漆 镜面 值得信懒 过关 值得表扬 没话说 爽 放心 没什么问题 没问题 完好无缺 完美无缺 喜欢 满意 赞 欣慰 欣喜 美了半天 开心 高兴 中意 稀饭 赞不绝口 惊喜 喜爱 感动 美 好到不行 舒心"

neg_emo_line="失败 不乍得 偷奸耍滑 晕 抱歉 调皮 廉价 有问题 用不了 蜗牛 忽悠 渣 瑕疵 坑爹 亏 不符合 不对条 不怎么的 不敢恭维 延迟 无法忍受 没有信用 不讲信用 太破 太烂 次品 毛病 名不符实 名不副实 名不见经传 不咋滴 不咋地 不咋的 受不了 受害 缩水 徒有虚名 退色 虚名 有所不同 找麻烦 起毛 粘毛 shiwang 脱线 哀怨 碍事 碍眼 暗 暗淡 暗淡无光 肮脏 败兴 薄弱 保守 暴怒 悲哀 悲惨 悲楚 悲愤 悲观 悲凉 悲伤 悲痛 卑劣 背时 被动 笨重 闭塞 憋气 憋屈 别扭 不安 不便 不畅 不当 不对 不公 不苟 不合 不济 不经意 不均 不快 不利 不力 不良 不灵 不满 不妙 不配 不起眼 不如意 不善 不适 不顺 不通 不妥 不像话 不行 不悦 不中意 不周 不准 不足 残 残酷 残忍 惭愧 惨 惨烈 惨痛 惨重 苍白 仓促 糙 差 差劲 诧异 猖狂 猖獗 超次 潮湿 吵闹 沉闷 沉重 陈旧 撑不住 吃紧 吃亏 吃力 迟顿 迟钝 迟缓 迟疑 迟滞 赤裸 冲 冲动 挂羊头卖狗肉 丑 丑恶 丑陋 臭 臭屁 蠢 刺鼻 刺耳 刺眼 匆忙 凑和 凑合 粗鄙 粗糙 粗劣 粗鲁 粗略 粗俗 粗心 脆弱 错乱 错误 掉毛 错愕 大忙 大意 呆板 呆滞 耽心 单薄 单调 单一 胆大 胆怯 胆小 淡薄 倒霉 倒楣 得意 低级 低劣 低落 低能 低俗 低洼 低下 刁 刁蛮 刁钻 掉色 丢脸 丢人 动摇 毒 堵心 短命 多事 多心 多疑 多余 恶劣 恶心 耳背 发愁 发霉 发怵 乏力 乏味 繁复 繁琐 繁杂 繁重 烦闷 烦恼 烦气 烦人 坑人 烦琐 烦心 地摊货 烦躁 反常 反感 犯贱 犯晕 非常次 肥 肥大 费解 费力 费钱 费神 费时 费事 愤慨 愤怒 风流 肤浅 浮华 拿不出手 浮躁 腐败 腹黑 干涩 高傲 高涨 隔膜 孤独 古板 寡欢 寡言 怪怪 怪怪的 怪异 怪癖 龟毛 诡异 诡谲 过火 过时 过头 过细 骇人听闻 含糊 含混 寒冷 寒酸 寒碜 汗颜 好动 好斗 好强 好色 好事 好笑 黑暗 很次 狠辣 狠心 横 猴急 厚颜 后悔 胡涂 糊涂 花巧 花哨 滑稽 滑腻 坏的 坏了 缓慢 荒谬 荒唐 慌乱 慌张 晃眼 恍惚 灰心 晦气 昏暗 浑浊 混乱 混浊 混沌 机械 饥渴 激烈 急迫 急躁 急噪 寂寞 尖刻 尖锐 尖酸 艰苦 艰难 艰险 艰辛 简陋 贱 僵 僵硬 焦 焦急 焦虑 焦躁 焦灼 骄傲 娇贵 娇气 娇柔 狡猾 较真 结巴 解恨 惊慌 惊险 惊愕 窘 揪心 纠结 旧 拘束 局促 沮丧 倔 倔强 绝望 坎坷 苛刻 可悲 可耻 可恶 可恨 可怕 可气 可叹 可笑 可疑 刻薄 坑洼 空荡 空洞 空虚 恐怖 恐慌 恐惧 抠 抠门 扣门 枯燥 苦闷 苦恼 快干 狂 狂傲 狂乱 狂热 狂晕 狂躁 亏心 愧疚 困惑 困难 辣手 来劲 懒 懒惰 懒散 滥 狼狈 劳顿 劳烦 劳苦 劳累 老成 老到 老练 老迈 老派 老气 老套 累人 累赘 美中不足 冷淡 冷酷 冷落 冷漠 冷僻 冷清 冷血 离谱 离奇 潦草 潦倒 吝啬 零乱 零散 零碎 凌乱 笼统 卤莽 鲁莽 乱 罗唆 罗嗦 落后 落寞 麻痹 麻木 马虎 蛮横 慢 漫长 茫然 盲目 忙乱 毛糙 矛盾 冒昧 冒失 没出息 没劲 没脸 没意思 闷气 蒙昧 迷惑 迷离 迷茫 迷惘 勉强 渺小 命苦 模糊 陌生 难办 难缠 难吃 难懂 难过 难堪 难看 难受 难听 难闻 恼火 恼怒 恼人 牛气 浓烈 怕老婆 怕人 疲惫 疲乏 疲倦 疲劳 疲软 偏激 偏僻 偏心 偏远 偏执 片面 贫贱 贫苦 贫穷 贫瘠 平淡 平庸 婆心 破 破戒 破旧 破烂 破碎 凄惨 凄凉 奇多 奇奇怪怪 崎岖 起劲 气愤 气恼 气馁 气盛 气死 牵强 浅薄 浅显 欠佳 欠缺 歉疚 强横 强硬 青涩 轻浮 轻率 情急 穷 穷酸 缺心眼 染色 任性 认生 冗长 柔弱 肉麻 入耳 软弱 弱小 散乱 散漫 骚 扫兴 色差 沙哑 傻 傻呼呼 善变 伤感 伤神 伤心 奢侈 深沉 生涩 生疏 生硬 失常 失望 势利 手软 瘦小 衰老 嘶哑 死板 死脑筋 松动 松散 怂 俗 俗气 随便 随意 琐碎 贪财 贪吃 贪婪 贪睡 贪心 讨人厌 疼痛 天真 痛苦 痛心 投机 头疼 头痛 土 土气 太久 非常久 褪色 退货 拖拉 拖沓 脱色 歪 外行 顽固 忘性 威风 微弱 危急 危险 为难 委屈 伪劣 紊乱 窝火 窝囊 窝心 卧槽 无常 无耻 无赖 无理 无礼 无聊 无奈 无能 无情 无味 无知 武断 稀薄 稀疏 细嫩 细碎 狭隘 狭小 狭窄 下作 吓人 险恶 嚣张 消极 邪恶 邪乎 懈怠 辛酸 心寒 心狠 心慌 心焦 心酸 心痛 心虚 腥 性急 凶 凶恶 凶悍 凶狠 凶猛 羞涩 虚浮 虚假 虚空 虚荣 虚伪 悬乎 悬殊 玄乎 逊色 压抑 严寒 严苛 严厉 严重 艳俗 痒 要面子 野 野蛮 一般 一般般 一身汗 遗憾 抑郁 易装 异常 异味 殷勤 阴 阴险 隐晦 拥挤 臃肿 庸俗 用力 忧愁 忧闷 忧伤 忧郁 犹疑 油滑 油腻 有害 有愧 幼小 幼稚 迂腐 愚笨 愚蠢 愚钝 愚昧 郁闷 冤枉 原始 圆滑 杂乱 脏 脏话 糟 糟糕 糟心 噪杂 造作 燥动 扎手 窄小 真次 稚嫩 中伤 主观 庄严 装嫩 壮烈 拙劣 自傲 自大 自恋 自私 最差 做作 剽悍 尴尬 拗 拮据 嘈杂 猥琐 惆怅 憔悴 邋遢 缭乱 暧昧 犟 腌臜 臊 忐忑 瞠 矜贵 聒噪 蹩脚 龌龊 黯淡 不怎么样 容易掉 麻烦 薄 单薄 色差 abandon abandoned abandoning abandonment abandons abate abated abates abating abdicate abdicated abdicates abdicating abhor abhorred abhorring abhors abject abjectly abnormal abnormally abolish abolished abolishes abolishing abominable abominably abrupt abruptly abscond absconded absconding absconds absence absent absented absentee absenting absently absents absurd absurdity absurdly abuse abused abuses abusing abusive abusively accident accidents accursed accusation accuse accused accuses accusing ache ached aches aching acrimonious acrimoniously acrimoniousness acrimony addiction admonish admonished admonishes admonishing admonition adulation adulterate adulteration adultery adversary adverse adversity affectation afflict affliction afraid against aggravate aggravation aggression aggressive aggressiveness aggressor aggrieve aghast agitate agitation agitator agonize agony ail ailment aimless alarm alarming alas alibi alien alienate alienation allegation allege aloof altercation ambiguity ambiguous ambivalent ambush amiss amputate anarchist anarchy anger angry anguish animosity annihilate annihilation annoy annoyance annoyed annoying annoys anomalous anomaly antagonism antagonist antagonistic antagonize anti-social antipathy antiquated antitrust anxiety anxious anxiousness apathetic apathy appall arduous arrest arrogance arrogant ascribe ashamed assail assailant assassin assassinate assault astray asunder atrocious atrophy attack audacious audacity austere autocrat autocratic avarice avaricious avenge aversion awful awkward awkwardness backward backwardness bad badly baffle bafflement bail bait balk banal bandit bane banish banishment bankrupt bankruptcy barbarian barbarous barren barrier bashful bastard beastly beg beggar belated belie belittle belligerent bereave bereavement bereft berserk beseech beset besiege betray betrayal bewilder bewilderment bite bitter bitterness bizarre blackmail blah blame blast blatant bleak blemish blind blindness blockhead bloodshed bloodthirsty bloody blow blunder blunt blur blurt boast boastful bogus boisterous bondage bore boredom boring bother bothersome bound brag brandish brat bravado brawl brazen breach break breakdown breaking bribe bristle brittle broke broken broken-hearted brood bruise brusque brutality brute brutish buckle bug bullet bum bungle burden burdensome burglar burglary burn bury busybody butchery calamity callous cancel cancellation cancer cannibal cannon capitulate capricious capsize captive capture careen careless carelessness cataclysm catastrophe cave censure chafe challenge chaos chaotic chase chastise cheap cheapen cheater chide childish choke chore chronic clamor clamorous clash clatter clique clog clumsy clutter cluttered cluttering clutters coarse coarseness cockiness cocky coerce coercion coercive collapse collide collision collusion colony combat combatant commiseration commit commoner commonplace commotion compel complain complaint complex complexity complicate complication complicity compulsion conceal conceit condemn condemnation condescending condescension confess confession confine confinement confiscate confiscation conflict confound confront confrontation confuse confused confuses confusing confusion congested congestion conspiracy conspirator conspire consternation constrain constraint consumptive contagious contaminate contamination contempt contemptible contemptuous contend contradict contradiction contradictory contrary controversial controversy convict cool coolness corrode corrosion corrosive corrupt corruption cost costliness costly counteract counteraction counterfeit covert covet coward crafty cram cramp cranky crass crave crawl craze craziness crazy credulous crime criminal cringe cripple crisis critic criticize croak crook crooked crude cruel cruelty crumble crumple crush crushing culpable culprit cumbersome curse cursory curt curtail cynical cynicism damage damn damnable damned danger dangerous dark darken darkness daunting dawdle daze dead deadlock deadly deadweight deaf deafness dearth debatable debtor decadence decadent decay decease deceit deceitful deceive deception deceptive decline decompose decrease defame default defeat defect defective defiance defiant deficiency deficient deficit defile defy degenerate degrade dejected delay delinquency delinquent delirium deluge delusion demean demise demolish demon demoralize denial denounce dent deny deplete deplorable deplore depose depraved depreciate depreciation depress depression deprive deride derision derisive derogatory descend desert/vb deserted/vb deserting/vb desertion deserts/vb desolate desolation despair desperate desperation despicable despise destitute destroy destruction destructive detachment detain deter deterrent detest detestable detract detrimental devastate devastation deviate deviation devil devilish devious devoid diabolic diabolical diatribe dictate dictatorial differ difficult difficulty dilemma dim din dire dirt dirty disable disadvantage disadvantageous disagreeable disagreement disappoint disappointed disappointing disappointment disappoints disapproval disapprove disarm disaster disastrous disavow disavowal disbelief discharge disclaim discomfort disconcerted discontent discord discordant discourage discouragement discredit discrepant discriminate disdain disease diseased disfavour disfavoured disfavouring disfavours disgrace disguise disgust dishearten dishonest dishonor disingenuous disinterest dislike disliked dislikes disliking dismal dismiss disobedience disobedient disorder disorganized dispel dispensability dispense displace displease displeasure disposal dispose disproportionate disprove disputable dispute disregard disrupt disruption dissatisfaction dissatisfied dissatisfy dissent dissention dissolution distaste distasted distasteful distastes distasting distort distortion distract distracting distraction distress distrustful disturb disturbance disturbed disturbing disturbs diversion divert divorce dizzy doldrums dominate domination doom doomsday dope doubt doubtful downcast downfall downhearted drab dread dreadful dreary droop drop drought drown drowsiness drowsy drunk drunkard drunken dubious dull dumb dump dunce dungeon dwindle dying yiban eccentric eccentricity egotistical eliminate elimination embarrass embarrassment emergency empty encroach encroachment endanger enemy enforce engulf enrage enslave entangle entanglement entreat envious envy epidemic epithet equivocal eradicate erase erode erosion err erroneous error errors esoteric estranged evade evasion evict evil exaggeration exasperate exasperation excess excessive exclude exclusion excommunication execute exempt exhaust exhaustion exile exit expedient expel expense expensive experienceless explode exploit explosion explosive expose exterminate extermination extinct extinguish extravagant fabricate fabrication fail failed failing fails failure faint fake fall fallacy fallen falling fallout falls FALSE falsehood falter famine famished fanatic fanatical farce fascist fatal fatalistic fatigue fault fear fearful fearsome feeble feign feint ferocious ferocity feud feudal fever feverish fiasco fickle fidget fiend fierce filth filthy fire fist fix flagrant flaw fled flee fleeting flimsy floor flounder foe foible fool foolish foolishness forbid forbidden force forced forces forcing foreboding forfeit forget forgetfulness forgets forgetting forgot forgotten forlorn formidable forsake fracture fragile frantic frantically fraud fraudulent fraught freak fret fretful friendless frighten frightful frigid frivolous frown fruitless frustrate frustration fugitive fumble furious fury fuss fussy futility fuzzy gall gamble gash gaudy germ ghastly ghetto glare gloat gloom gloomy glum goddamn grab grapple gratuitous grave grief grievance grieve grim grizzly grotesque growl grudge gruff grumble guerrilla guilt guilty guise gullible gunmen hack hackney hag haggard hamper handicap haphazard hapless harass harassment hard hardship harm harmful harsh hassle hast hasty hate hated hateful hatefully hater hates hating hatred haughty haunt havoc hazard hazardous haziness hazy headache heartless hectic hedge hedonistic heedless heinous hell helpless helplessness hideous hinder hindrance hit hoard hobble hole hollow homely hopeless hopelessly horde horn horrible horrid horrify horror hostile hostility humble humiliate humiliation hung hunger hungry hurt hurtful hustle hustler hypocrisy hypocrite hysteria hysterical idiot idiotic idleness ignoble ignorance ignorant ignore ignore ignored ignores ignoring ill illegal illegality illiterate illness illogical immature immobility immoral immorality immovable impair impasse impatience impatient impede impediment imperfect impersonal impetuous implicate implore impose imprecise imprecision imprecisly imprison imprisonment improper impulsive impure impurity inability inaccessible inaccuracy inadequate inane incapable incessant incompatibility incompatible incompetence incompetent inconsistency inconvenient incorrect incredible incurable indecent indefinite indeterminable indeterminate indictment indifference indifferent indignation indulge ineffective ineffectiveness ineffectual ineffectualness inefficiency inequality inexact inexplicable infamous infect infection inferior inferiority infest infiltration inflame inflation inflict infraction infringement infuriate ingratitude inhibit inhibition inhumane injunction injure injurious injury insane insecure insecurity insensible insidious insignificant insinuate insolence insolent instability instable insufficiency insufficient insult interfere interference interrupt interruption intervention intimidate intolerable intoxicate intrude intruder intrusion inundate inundated invade invalid invisible involuntary irk iron ironic irony irrational irregular irregularity irresponsible irritable irritation isolate jail jar jeer jeopardize jeopardy jerk jittery jobless jumpy junk kick kidnap lack lacked lacking lacks lag lame lament lamentable languish lapse late lawless lazily lazy leak leakage liability liable liar lie lifeless limit limitation limp litter load lone loneliness lonely loner lonesome loom lose loser loss lost loveless low lower lowly ludicrous lull lunatic lure lurk lying mad madman madness maladjusted maladjustment malady malice malicious malignant mangle manslaughter mar marginal massacre meager meaningless meddle mediocre meek melancholy melodramatic menace menial merciless mess mind misbehave misbehavior mischief mischievous miser miserable misery misfortune mishandle mishap misinform misinformed mislead misleaded misleading misleads misrepresent miss missed misses missing mistake mistaken mistakes mistaking mistrust misunderstand misunderstanding misunderstood misuse mix moan mock mockery molest monotonous monotony monster monstrous moody mortify motionless motley mourn mourner muddle muddled muddles muddling muddy mumble mundane murderous murky mutter myself> nag naive nasty naughty nauseate nauseated nauseates nauseating nebulous needy negate negation 1002e neglect negligence negligent nervous nervousness neurotic neutralize nightmare nix noise nonchalant nonsense nosey notorious nuisance nullification nullify numb nuts object/vb objected/vb objecting/vb objection objector objects/vb oblique obliterate obnoxious obscure obsolete obstacle obstinate obstruct obstruction odd oddity offend offender offensive ominous omission omit opinionated opponent oppose opposition oppress oppression oppressive ordeal orphan ostracize oust outbreak outburst outcast outcry outlaw outrage outrageous outsider overbearing overflow overlook overpower overrun oversight overthrow overturn overwhelming overworked owe pain pained painful painfully painfulness paining pains paltry pandemonium panic paralysis paralyzed paranoid parasite partition passe pathetic patronize peculiar peril perilous perish perplex perplexity persecute persecution perturb perverse pervert pessimism pessimistic pest petty phobia pinch pitiful pitiless plague plaintiff plight plod poignant pointless poison poisonous pollute pollution pompous poor poorly pound pout poverty powerless precarious precipitate predicament prejudice prejudicial preposterous presumptuous pretend pretense pretentious prison prisoner problem procrastinate procrastination prod prohibit prohibition prohibitive propaganda prosecution protest provocation provoke prowl pry punch punish puny puzzlement qualm quandary quarrel quarrelsome queer question questionable questionably questioned questioning questions quibble quit quitter radical rage raid ramble rampant rascal rash rat ration rattle ravage reactionary reactive rebel rebellion rebellious rebuff rebuke rebut recalcitrant recede recession reckless recklessness recoil redundancy redundant refrain refugee refusal refuse regardless regress regression regret regrettable reject rejection relapse reluctant remorse renounce renunciation repeal reprehensible repress reproach repudiate repugnant repulse repulsive resent resentful resentment resignation restless restlessness restrict restriction retaliate retard retire retreat revenge revert revoke revolt rid ridicule ridiculous rigid rigor rigorous rip risky rival rivalry robber robbery rogue root rot rotten rough roughness roundabout rubbish rude rue ruffian ruin ruinous rumor rumple runaway rupture rusty ruthless ruthlessness sabotage sad sadness sag sank sap sarcasm sarcastic savage scald scandal scandalous scapegoat scar scarcity scare scared scary scheme scoff scold scorch scorn scornful scoundrel scowl scrape scream screech screw scrutinize scuffle scum secede secession secrecy secret sedentary seethe segregation seize selfish selfishness senile senseful senseless sequester serious servitude sever severe severity shabby shadow shady shaggy shake shallow shame shameful shameless shark shell shipwreck shirk shiver shock shoddy shoot short shortage shortcoming shortsighted shove shred shrew shriek shrill shrivel shroud shrug shun shyness sick sickly sickness siege silly simplistic sin sinful sinister skeptical sketchy skirmish skulk slam slander slanderer slanderous slap slash slaughter slayer sleazy sleepless slight sloppy sloth slothful slug sluggish slump sly smack smash smear smother smuggle snare snarl snatch sneak sneer snore sob somber sore soreness sorrow sorrowful sorry sour spank spear spill spinster spiteful spitefully split spoil spot sprain sputter squander stab stagnant stain stale stalemate stammer stamp standstill stark startle starvation starve steal stern stick stifle stigma sting stink stole stolen storm stormy straggle straggler strain strangle stray stress stricken strict strife stringent struck stubborn stubbornly stubbornness stuffy stunt stupid stupidity stupor subjection subjugate subjugation submissive subservience subside substitution subtract subversion subvert succumb suffer sufferer suffocate sullen sunder superficial superficiality superfluous superstition superstitious suppress suppression susceptible suspect suspectable suspectablly suspected suspecting suspects suspend suspension suspicion suspicious swear swore symptom taboo taint tamper tantrum tardy tatter taunt tax tear tease tedious temper tempest temptation tense tension terrible terrify terror terrorism terrorize thankless theft thief thirst thirsty thorny thoughtless thrash threat threaten thrill throw thud thwart timidity tire tired tiresome toil tolerable topple torment torrent torturous touchy tragedy tragic traitor tramp trample transgress trap trauma traumatic treacherous treachery treason treasonous trespass trick trivial trouble troubled troubles troublesome troubling truant trudge turbulent turmoil twitch tyranny ugly ultimatum unaccept unacceptable unacceptably unaccepted unaccepting unaccepts unaccustomed unarm unattractive unauthentic unavoidable unbearable unbelievable uncivil unclean unclear uncomfortable unconvince unconvinced unconvinces unconvincing uncouth undependability undependable undermine underworld undesirable undid undignified undo undone undue uneasiness uneasy uneconomical unemployed unequal uneven unexpectedly unfair unfaithful unfamiliar unfavorable unfavorably unfeeling unfit unforeseen unfortunate unfortunately unfriendly ungrateful unguarded unhappily unhappiness unhappy unhealthy unimportant uninformed unjust unjustified unkind unlawful unlucky unmoved unnatural unnecessary unnerve unnoticed unobserved unpleasant unpopular unprofitable unqualified unreasonable unreliability unreliable unrest unruly unsafe unsatisfactory unscrupulous unseen unsettling unsound unspeakable unstable unsteadiness unsteady unsuccess unsuccessful unsuccessfully unsympathetic unthank unthankful unthankfully unthankfulness untimely untrained untrue untrustworthy untruth unuse unuse unused unuseful unusefully unusefulness unuses unusing unwilling unwillingness unwise unworthy upheaval uprising uproar uproot upset useless uselessly uselessness usurp utterance vagabond vagrant vague vagueness vain vanish vanity vehement vengeance venom venomous veto vex vexation vexing vice vicious vie vile villain violate violation violence violent viper void volatile volatility vomit vulgar wail wallow wane wanton warfare warlike warp wary waste wasted wasteful wastefully wastefulness wastes wasting wayward weaken wear weariness wearisome wee weed weep weird wench whack whimper whine whip wicked wickedness wild willful wilt wily wince witchcraft withheld withhold woe woeful wonder/vb wondered/vb wondering/vb wonders/vb worrier worry worse worsen worst worthless wound wrath wreck wrestle wretch wretchedness wrinkle writhe wrong wrongful wrought yawn yearn yelp buxing hencha taichale 不行 冰冷 中毒 气人 没用 不尽如人意 不大方便 不大对 不大好闻 假的 过期 对不上 刮花 磨花 划痕 划伤 指纹 伤痕 刮痕 嫌疑 延误 暴力 垃圾 弱 lj 不咋样 没什么感觉 不怎么滴 久等 错 缺陷 困扰 掉了 小问题 缺点 叼 无法接受 假 跟不上 施舍 亏大了 狰狞 无语 失望 生气 差到不行"


pos_emo_set=set([i.strip().decode('utf-8') for  i in pos_emo_line.split()])
neg_emo_set=set([i.strip().decode('utf-8') for  i in neg_emo_line.split()])
neg_set    =set([i.strip().decode('utf-8') for  i in neg_line.split()])
def pos_neg(words):
    words_set=set(words.split('\002'))
    neg = len(neg_set&words_set)
    neg_emo = len(neg_emo_set&words_set)
    pos_emo = len(pos_emo_set&words_set)
    # return '_'.join(str(i) for i in [neg,neg_emo,pos_emo])
    flag=0
    if neg>0 and pos_emo>0:flag= -1
    if neg>0 and neg_emo>0: flag= 1
    if neg==0 and pos_emo>0: flag= 1
    if neg==0 and neg_emo>0: flag= -1
    if neg==0 and pos_emo==0 and neg_emo==0 :flag= 0
    return flag,'_'.join(str(i) for i in [neg,neg_emo,pos_emo])


path='/user/zlj/data/feed_2015_alicut_parse/parse_split_clean_cut_part-00000_0002'

rdd=sc.textFile(path).map(lambda x:getfield(x)).filter(lambda x:x is not None).map(lambda x: '\t'.join([ f_coding(i) for i in x]))
rdd.saveAsTextFile('/user/zlj/data/feed_2015_alicut_parse_emo_test')