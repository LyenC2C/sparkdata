


create table  t_base_user_comsum_statis_cat_ratio as
SELECT
user_id ,
sum(case when root_cat_id=11         then price else 0 end)/sum(price) as          11_ratio ,
sum(case when root_cat_id=1101       then price else 0 end)/sum(price) as            1101_ratio ,
sum(case when root_cat_id=1201       then price else 0 end)/sum(price) as            1201_ratio ,
sum(case when root_cat_id=120886001  then price else 0 end)/sum(price) as                 120886001_ratio ,
sum(case when root_cat_id=121380001  then price else 0 end)/sum(price) as                 121380001_ratio ,
sum(case when root_cat_id=121536003  then price else 0 end)/sum(price) as                 121536003_ratio ,
sum(case when root_cat_id=121944003  then price else 0 end)/sum(price) as                 121944003_ratio ,
sum(case when root_cat_id=122352003  then price else 0 end)/sum(price) as                 122352003_ratio ,
sum(case when root_cat_id=122380005  then price else 0 end)/sum(price) as                 122380005_ratio ,
sum(case when root_cat_id=122650005  then price else 0 end)/sum(price) as                 122650005_ratio ,
sum(case when root_cat_id=122662002  then price else 0 end)/sum(price) as                 122662002_ratio ,
sum(case when root_cat_id=122684003  then price else 0 end)/sum(price) as                 122684003_ratio ,
sum(case when root_cat_id=122686003  then price else 0 end)/sum(price) as                 122686003_ratio ,
sum(case when root_cat_id=122696005  then price else 0 end)/sum(price) as                 122696005_ratio ,
sum(case when root_cat_id=122718004  then price else 0 end)/sum(price) as                 122718004_ratio ,
sum(case when root_cat_id=122852001  then price else 0 end)/sum(price) as                 122852001_ratio ,
sum(case when root_cat_id=122928002  then price else 0 end)/sum(price) as                 122928002_ratio ,
sum(case when root_cat_id=122950001  then price else 0 end)/sum(price) as                 122950001_ratio ,
sum(case when root_cat_id=122952001  then price else 0 end)/sum(price) as                 122952001_ratio ,
sum(case when root_cat_id=122966004  then price else 0 end)/sum(price) as                 122966004_ratio ,
sum(case when root_cat_id=123302001  then price else 0 end)/sum(price) as                 123302001_ratio ,
sum(case when root_cat_id=123690003  then price else 0 end)/sum(price) as                 123690003_ratio ,
sum(case when root_cat_id=124024001  then price else 0 end)/sum(price) as                 124024001_ratio ,
sum(case when root_cat_id=124044001  then price else 0 end)/sum(price) as                 124044001_ratio ,
sum(case when root_cat_id=124050001  then price else 0 end)/sum(price) as                 124050001_ratio ,
sum(case when root_cat_id=124164002  then price else 0 end)/sum(price) as                 124164002_ratio ,
sum(case when root_cat_id=124164003  then price else 0 end)/sum(price) as                 124164003_ratio ,
sum(case when root_cat_id=124242008  then price else 0 end)/sum(price) as                 124242008_ratio ,
sum(case when root_cat_id=124354002  then price else 0 end)/sum(price) as                 124354002_ratio ,
sum(case when root_cat_id=124458005  then price else 0 end)/sum(price) as                 124458005_ratio ,
sum(case when root_cat_id=124466001  then price else 0 end)/sum(price) as                 124466001_ratio ,
sum(case when root_cat_id=124468001  then price else 0 end)/sum(price) as                 124468001_ratio ,
sum(case when root_cat_id=124470001  then price else 0 end)/sum(price) as                 124470001_ratio ,
sum(case when root_cat_id=124470006  then price else 0 end)/sum(price) as                 124470006_ratio ,
sum(case when root_cat_id=124484008  then price else 0 end)/sum(price) as                 124484008_ratio ,
sum(case when root_cat_id=124568010  then price else 0 end)/sum(price) as                 124568010_ratio ,
sum(case when root_cat_id=124602001  then price else 0 end)/sum(price) as                 124602001_ratio ,
sum(case when root_cat_id=124698018  then price else 0 end)/sum(price) as                 124698018_ratio ,
sum(case when root_cat_id=124840002  then price else 0 end)/sum(price) as                 124840002_ratio ,
sum(case when root_cat_id=124844002  then price else 0 end)/sum(price) as                 124844002_ratio ,
sum(case when root_cat_id=124868003  then price else 0 end)/sum(price) as                 124868003_ratio ,
sum(case when root_cat_id=14         then price else 0 end)/sum(price) as          14_ratio ,
sum(case when root_cat_id=1410       then price else 0 end)/sum(price) as            1410_ratio ,
sum(case when root_cat_id=1512       then price else 0 end)/sum(price) as            1512_ratio ,
sum(case when root_cat_id=16         then price else 0 end)/sum(price) as          16_ratio ,
sum(case when root_cat_id=1625       then price else 0 end)/sum(price) as            1625_ratio ,
sum(case when root_cat_id=1705       then price else 0 end)/sum(price) as            1705_ratio ,
sum(case when root_cat_id=1801       then price else 0 end)/sum(price) as            1801_ratio ,
sum(case when root_cat_id=20         then price else 0 end)/sum(price) as          20_ratio ,
sum(case when root_cat_id=21         then price else 0 end)/sum(price) as          21_ratio ,
sum(case when root_cat_id=2128       then price else 0 end)/sum(price) as            2128_ratio ,
sum(case when root_cat_id=23         then price else 0 end)/sum(price) as          23_ratio ,
sum(case when root_cat_id=25         then price else 0 end)/sum(price) as          25_ratio ,
sum(case when root_cat_id=26         then price else 0 end)/sum(price) as          26_ratio ,
sum(case when root_cat_id=27         then price else 0 end)/sum(price) as          27_ratio ,
sum(case when root_cat_id=28         then price else 0 end)/sum(price) as          28_ratio ,
sum(case when root_cat_id=2813       then price else 0 end)/sum(price) as            2813_ratio ,
sum(case when root_cat_id=29         then price else 0 end)/sum(price) as          29_ratio ,
sum(case when root_cat_id=30         then price else 0 end)/sum(price) as          30_ratio ,
sum(case when root_cat_id=3009       then price else 0 end)/sum(price) as            3009_ratio ,
sum(case when root_cat_id=33         then price else 0 end)/sum(price) as          33_ratio ,
sum(case when root_cat_id=34         then price else 0 end)/sum(price) as          34_ratio ,
sum(case when root_cat_id=35         then price else 0 end)/sum(price) as          35_ratio ,
sum(case when root_cat_id=40         then price else 0 end)/sum(price) as          40_ratio ,
sum(case when root_cat_id=50002766   then price else 0 end)/sum(price) as                50002766_ratio ,
sum(case when root_cat_id=50002768   then price else 0 end)/sum(price) as                50002768_ratio ,
sum(case when root_cat_id=50003754   then price else 0 end)/sum(price) as                50003754_ratio ,
sum(case when root_cat_id=50004958   then price else 0 end)/sum(price) as                50004958_ratio ,
sum(case when root_cat_id=50006842   then price else 0 end)/sum(price) as                50006842_ratio ,
sum(case when root_cat_id=50006843   then price else 0 end)/sum(price) as                50006843_ratio ,
sum(case when root_cat_id=50007216   then price else 0 end)/sum(price) as                50007216_ratio ,
sum(case when root_cat_id=50007218   then price else 0 end)/sum(price) as                50007218_ratio ,
sum(case when root_cat_id=50008075   then price else 0 end)/sum(price) as                50008075_ratio ,
sum(case when root_cat_id=50008090   then price else 0 end)/sum(price) as                50008090_ratio ,
sum(case when root_cat_id=50008097   then price else 0 end)/sum(price) as                50008097_ratio ,
sum(case when root_cat_id=50008141   then price else 0 end)/sum(price) as                50008141_ratio ,
sum(case when root_cat_id=50008163   then price else 0 end)/sum(price) as                50008163_ratio ,
sum(case when root_cat_id=50008164   then price else 0 end)/sum(price) as                50008164_ratio ,
sum(case when root_cat_id=50008165   then price else 0 end)/sum(price) as                50008165_ratio ,
sum(case when root_cat_id=50008168   then price else 0 end)/sum(price) as                50008168_ratio ,
sum(case when root_cat_id=50008171   then price else 0 end)/sum(price) as                50008171_ratio ,
sum(case when root_cat_id=50008825   then price else 0 end)/sum(price) as                50008825_ratio ,
sum(case when root_cat_id=50008907   then price else 0 end)/sum(price) as                50008907_ratio ,
sum(case when root_cat_id=50010388   then price else 0 end)/sum(price) as                50010388_ratio ,
sum(case when root_cat_id=50010404   then price else 0 end)/sum(price) as                50010404_ratio ,
sum(case when root_cat_id=50010728   then price else 0 end)/sum(price) as                50010728_ratio ,
sum(case when root_cat_id=50010788   then price else 0 end)/sum(price) as                50010788_ratio ,
sum(case when root_cat_id=50011397   then price else 0 end)/sum(price) as                50011397_ratio ,
sum(case when root_cat_id=50011665   then price else 0 end)/sum(price) as                50011665_ratio ,
sum(case when root_cat_id=50011699   then price else 0 end)/sum(price) as                50011699_ratio ,
sum(case when root_cat_id=50011740   then price else 0 end)/sum(price) as                50011740_ratio ,
sum(case when root_cat_id=50011949   then price else 0 end)/sum(price) as                50011949_ratio ,
sum(case when root_cat_id=50011972   then price else 0 end)/sum(price) as                50011972_ratio ,
sum(case when root_cat_id=50012029   then price else 0 end)/sum(price) as                50012029_ratio ,
sum(case when root_cat_id=50012082   then price else 0 end)/sum(price) as                50012082_ratio ,
sum(case when root_cat_id=50012100   then price else 0 end)/sum(price) as                50012100_ratio ,
sum(case when root_cat_id=50012164   then price else 0 end)/sum(price) as                50012164_ratio ,
sum(case when root_cat_id=50012472   then price else 0 end)/sum(price) as                50012472_ratio ,
sum(case when root_cat_id=50012769   then price else 0 end)/sum(price) as                50012769_ratio ,
sum(case when root_cat_id=50013864   then price else 0 end)/sum(price) as                50013864_ratio ,
sum(case when root_cat_id=50013886   then price else 0 end)/sum(price) as                50013886_ratio ,
sum(case when root_cat_id=50014442   then price else 0 end)/sum(price) as                50014442_ratio ,
sum(case when root_cat_id=50014476   then price else 0 end)/sum(price) as                50014476_ratio ,
sum(case when root_cat_id=50014811   then price else 0 end)/sum(price) as                50014811_ratio ,
sum(case when root_cat_id=50014812   then price else 0 end)/sum(price) as                50014812_ratio ,
sum(case when root_cat_id=50014927   then price else 0 end)/sum(price) as                50014927_ratio ,
sum(case when root_cat_id=50016348   then price else 0 end)/sum(price) as                50016348_ratio ,
sum(case when root_cat_id=50016349   then price else 0 end)/sum(price) as                50016349_ratio ,
sum(case when root_cat_id=50016422   then price else 0 end)/sum(price) as                50016422_ratio ,
sum(case when root_cat_id=50016768   then price else 0 end)/sum(price) as                50016768_ratio ,
sum(case when root_cat_id=50016891   then price else 0 end)/sum(price) as                50016891_ratio ,
sum(case when root_cat_id=50017133   then price else 0 end)/sum(price) as                50017133_ratio ,
sum(case when root_cat_id=50017300   then price else 0 end)/sum(price) as                50017300_ratio ,
sum(case when root_cat_id=50017652   then price else 0 end)/sum(price) as                50017652_ratio ,
sum(case when root_cat_id=50017673   then price else 0 end)/sum(price) as                50017673_ratio ,
sum(case when root_cat_id=50017708   then price else 0 end)/sum(price) as                50017708_ratio ,
sum(case when root_cat_id=50017908   then price else 0 end)/sum(price) as                50017908_ratio ,
sum(case when root_cat_id=50018004   then price else 0 end)/sum(price) as                50018004_ratio ,
sum(case when root_cat_id=50018222   then price else 0 end)/sum(price) as                50018222_ratio ,
sum(case when root_cat_id=50018252   then price else 0 end)/sum(price) as                50018252_ratio ,
sum(case when root_cat_id=50018264   then price else 0 end)/sum(price) as                50018264_ratio ,
sum(case when root_cat_id=50018719   then price else 0 end)/sum(price) as                50018719_ratio ,
sum(case when root_cat_id=50019095   then price else 0 end)/sum(price) as                50019095_ratio ,
sum(case when root_cat_id=50019478   then price else 0 end)/sum(price) as                50019478_ratio ,
sum(case when root_cat_id=50019780   then price else 0 end)/sum(price) as                50019780_ratio ,
sum(case when root_cat_id=50020274   then price else 0 end)/sum(price) as                50020274_ratio ,
sum(case when root_cat_id=50020275   then price else 0 end)/sum(price) as                50020275_ratio ,
sum(case when root_cat_id=50020332   then price else 0 end)/sum(price) as                50020332_ratio ,
sum(case when root_cat_id=50020485   then price else 0 end)/sum(price) as                50020485_ratio ,
sum(case when root_cat_id=50020579   then price else 0 end)/sum(price) as                50020579_ratio ,
sum(case when root_cat_id=50020611   then price else 0 end)/sum(price) as                50020611_ratio ,
sum(case when root_cat_id=50020670   then price else 0 end)/sum(price) as                50020670_ratio ,
sum(case when root_cat_id=50020808   then price else 0 end)/sum(price) as                50020808_ratio ,
sum(case when root_cat_id=50020857   then price else 0 end)/sum(price) as                50020857_ratio ,
sum(case when root_cat_id=50022517   then price else 0 end)/sum(price) as                50022517_ratio ,
sum(case when root_cat_id=50022649   then price else 0 end)/sum(price) as                50022649_ratio ,
sum(case when root_cat_id=50022703   then price else 0 end)/sum(price) as                50022703_ratio ,
sum(case when root_cat_id=50022987   then price else 0 end)/sum(price) as                50022987_ratio ,
sum(case when root_cat_id=50023282   then price else 0 end)/sum(price) as                50023282_ratio ,
sum(case when root_cat_id=50023575   then price else 0 end)/sum(price) as                50023575_ratio ,
sum(case when root_cat_id=50023717   then price else 0 end)/sum(price) as                50023717_ratio ,
sum(case when root_cat_id=50023722   then price else 0 end)/sum(price) as                50023722_ratio ,
sum(case when root_cat_id=50023804   then price else 0 end)/sum(price) as                50023804_ratio ,
sum(case when root_cat_id=50024186   then price else 0 end)/sum(price) as                50024186_ratio ,
sum(case when root_cat_id=50024971   then price else 0 end)/sum(price) as                50024971_ratio ,
sum(case when root_cat_id=50025004   then price else 0 end)/sum(price) as                50025004_ratio ,
sum(case when root_cat_id=50025110   then price else 0 end)/sum(price) as                50025110_ratio ,
sum(case when root_cat_id=50025111   then price else 0 end)/sum(price) as                50025111_ratio ,
sum(case when root_cat_id=50025618   then price else 0 end)/sum(price) as                50025618_ratio ,
sum(case when root_cat_id=50025705   then price else 0 end)/sum(price) as                50025705_ratio ,
sum(case when root_cat_id=50025706   then price else 0 end)/sum(price) as                50025706_ratio ,
sum(case when root_cat_id=50025707   then price else 0 end)/sum(price) as                50025707_ratio ,
sum(case when root_cat_id=50025881   then price else 0 end)/sum(price) as                50025881_ratio ,
sum(case when root_cat_id=50025968   then price else 0 end)/sum(price) as                50025968_ratio ,
sum(case when root_cat_id=50026316   then price else 0 end)/sum(price) as                50026316_ratio ,
sum(case when root_cat_id=50026523   then price else 0 end)/sum(price) as                50026523_ratio ,
sum(case when root_cat_id=50026555   then price else 0 end)/sum(price) as                50026555_ratio ,
sum(case when root_cat_id=50026800   then price else 0 end)/sum(price) as                50026800_ratio ,
sum(case when root_cat_id=50050358   then price else 0 end)/sum(price) as                50050358_ratio ,
sum(case when root_cat_id=50050359   then price else 0 end)/sum(price) as                50050359_ratio ,
sum(case when root_cat_id=50050471   then price else 0 end)/sum(price) as                50050471_ratio ,
sum(case when root_cat_id=50074001   then price else 0 end)/sum(price) as                50074001_ratio ,
sum(case when root_cat_id=50158001   then price else 0 end)/sum(price) as                50158001_ratio ,
sum(case when root_cat_id=50454031   then price else 0 end)/sum(price) as                50454031_ratio ,
sum(case when root_cat_id=50468001   then price else 0 end)/sum(price) as                50468001_ratio ,
sum(case when root_cat_id=50488001   then price else 0 end)/sum(price) as                50488001_ratio ,
sum(case when root_cat_id=50510002   then price else 0 end)/sum(price) as                50510002_ratio ,
sum(case when root_cat_id=50802001   then price else 0 end)/sum(price) as                50802001_ratio ,
sum(case when root_cat_id=6666666    then price else 0 end)/sum(price) as               6666666_ratio ,
sum(case when root_cat_id=7777777    then price else 0 end)/sum(price) as               7777777_ratio ,
sum(case when root_cat_id=98         then price else 0 end)/sum(price) as          98_ratio ,
sum(case when root_cat_id=99         then price else 0 end)/sum(price) as          99_ratio

from t_base_ec_record_dev_new_simple group by user_id ;