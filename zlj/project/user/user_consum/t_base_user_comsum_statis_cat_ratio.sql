


create table  t_base_user_comsum_statis_cat_ratio as

select
user_id ,
sum(price_11      )/sum(price)  as ratio_11,
sum(price_1101    )/sum(price)  as ratio_1101,
sum(price_1201    )/sum(price)  as ratio_1201,
sum(price_12088600)/sum(price)  as ratio_12088600,
sum(price_12138000)/sum(price)  as ratio_12138000,
sum(price_12153600)/sum(price)  as ratio_12153600,
sum(price_12194400)/sum(price)  as ratio_12194400,
sum(price_12235200)/sum(price)  as ratio_12235200,
sum(price_12238000)/sum(price)  as ratio_12238000,
sum(price_12265000)/sum(price)  as ratio_12265000,
sum(price_12266200)/sum(price)  as ratio_12266200,
sum(price_12268400)/sum(price)  as ratio_12268400,
sum(price_12268600)/sum(price)  as ratio_12268600,
sum(price_12269600)/sum(price)  as ratio_12269600,
sum(price_12271800)/sum(price)  as ratio_12271800,
sum(price_12285200)/sum(price)  as ratio_12285200,
sum(price_12292800)/sum(price)  as ratio_12292800,
sum(price_12295000)/sum(price)  as ratio_12295000,
sum(price_12295200)/sum(price)  as ratio_12295200,
sum(price_12296600)/sum(price)  as ratio_12296600,
sum(price_12330200)/sum(price)  as ratio_12330200,
sum(price_12369000)/sum(price)  as ratio_12369000,
sum(price_12402400)/sum(price)  as ratio_12402400,
sum(price_12404400)/sum(price)  as ratio_12404400,
sum(price_12405000)/sum(price)  as ratio_12405000,
sum(price_12416400)/sum(price)  as ratio_12416400,
sum(price_12424200)/sum(price)  as ratio_12424200,
sum(price_12435400)/sum(price)  as ratio_12435400,
sum(price_12445800)/sum(price)  as ratio_12445800,
sum(price_12446600)/sum(price)  as ratio_12446600,
sum(price_12446800)/sum(price)  as ratio_12446800,
sum(price_12447000)/sum(price)  as ratio_12447000,
sum(price_12448400)/sum(price)  as ratio_12448400,
sum(price_12456801)/sum(price)  as ratio_12456801,
sum(price_12460200)/sum(price)  as ratio_12460200,
sum(price_12469801)/sum(price)  as ratio_12469801,
sum(price_12484000)/sum(price)  as ratio_12484000,
sum(price_12484400)/sum(price)  as ratio_12484400,
sum(price_12486800)/sum(price)  as ratio_12486800,
sum(price_14      )/sum(price)  as ratio_14,
sum(price_1410    )/sum(price)  as ratio_1410,
sum(price_1512    )/sum(price)  as ratio_1512,
sum(price_16      )/sum(price)  as ratio_16,
sum(price_1625    )/sum(price)  as ratio_1625,
sum(price_1705    )/sum(price)  as ratio_1705,
sum(price_1801    )/sum(price)  as ratio_1801,
sum(price_20      )/sum(price)  as ratio_20,
sum(price_21      )/sum(price)  as ratio_21,
sum(price_2128    )/sum(price)  as ratio_2128,
sum(price_23      )/sum(price)  as ratio_23,
sum(price_25      )/sum(price)  as ratio_25,
sum(price_26      )/sum(price)  as ratio_26,
sum(price_27      )/sum(price)  as ratio_27,
sum(price_28      )/sum(price)  as ratio_28,
sum(price_2813    )/sum(price)  as ratio_2813,
sum(price_29      )/sum(price)  as ratio_29,
sum(price_30      )/sum(price)  as ratio_30,
sum(price_3009    )/sum(price)  as ratio_3009,
sum(price_33      )/sum(price)  as ratio_33,
sum(price_34      )/sum(price)  as ratio_34,
sum(price_35      )/sum(price)  as ratio_35,
sum(price_40      )/sum(price)  as ratio_40,
sum(price_50002766)/sum(price)  as ratio_50002766,
sum(price_50002768)/sum(price)  as ratio_50002768,
sum(price_50003754)/sum(price)  as ratio_50003754,
sum(price_50004958)/sum(price)  as ratio_50004958,
sum(price_50006842)/sum(price)  as ratio_50006842,
sum(price_50006843)/sum(price)  as ratio_50006843,
sum(price_50007216)/sum(price)  as ratio_50007216,
sum(price_50007218)/sum(price)  as ratio_50007218,
sum(price_50008075)/sum(price)  as ratio_50008075,
sum(price_50008090)/sum(price)  as ratio_50008090,
sum(price_50008097)/sum(price)  as ratio_50008097,
sum(price_50008141)/sum(price)  as ratio_50008141,
sum(price_50008163)/sum(price)  as ratio_50008163,
sum(price_50008164)/sum(price)  as ratio_50008164,
sum(price_50008165)/sum(price)  as ratio_50008165,
sum(price_50008168)/sum(price)  as ratio_50008168,
sum(price_50008171)/sum(price)  as ratio_50008171,
sum(price_50008825)/sum(price)  as ratio_50008825,
sum(price_50008907)/sum(price)  as ratio_50008907,
sum(price_50010388)/sum(price)  as ratio_50010388,
sum(price_50010404)/sum(price)  as ratio_50010404,
sum(price_50010728)/sum(price)  as ratio_50010728,
sum(price_50010788)/sum(price)  as ratio_50010788,
sum(price_50011397)/sum(price)  as ratio_50011397,
sum(price_50011665)/sum(price)  as ratio_50011665,
sum(price_50011699)/sum(price)  as ratio_50011699,
sum(price_50011740)/sum(price)  as ratio_50011740,
sum(price_50011949)/sum(price)  as ratio_50011949,
sum(price_50011972)/sum(price)  as ratio_50011972,
sum(price_50012029)/sum(price)  as ratio_50012029,
sum(price_50012082)/sum(price)  as ratio_50012082,
sum(price_50012100)/sum(price)  as ratio_50012100,
sum(price_50012164)/sum(price)  as ratio_50012164,
sum(price_50012472)/sum(price)  as ratio_50012472,
sum(price_50012769)/sum(price)  as ratio_50012769,
sum(price_50013864)/sum(price)  as ratio_50013864,
sum(price_50013886)/sum(price)  as ratio_50013886,
sum(price_50014442)/sum(price)  as ratio_50014442,
sum(price_50014476)/sum(price)  as ratio_50014476,
sum(price_50014811)/sum(price)  as ratio_50014811,
sum(price_50014812)/sum(price)  as ratio_50014812,
sum(price_50014927)/sum(price)  as ratio_50014927,
sum(price_50016348)/sum(price)  as ratio_50016348,
sum(price_50016349)/sum(price)  as ratio_50016349,
sum(price_50016422)/sum(price)  as ratio_50016422,
sum(price_50016768)/sum(price)  as ratio_50016768,
sum(price_50016891)/sum(price)  as ratio_50016891,
sum(price_50017133)/sum(price)  as ratio_50017133,
sum(price_50017300)/sum(price)  as ratio_50017300,
sum(price_50017652)/sum(price)  as ratio_50017652,
sum(price_50017673)/sum(price)  as ratio_50017673,
sum(price_50017708)/sum(price)  as ratio_50017708,
sum(price_50017908)/sum(price)  as ratio_50017908,
sum(price_50018004)/sum(price)  as ratio_50018004,
sum(price_50018222)/sum(price)  as ratio_50018222,
sum(price_50018252)/sum(price)  as ratio_50018252,
sum(price_50018264)/sum(price)  as ratio_50018264,
sum(price_50018719)/sum(price)  as ratio_50018719,
sum(price_50019095)/sum(price)  as ratio_50019095,
sum(price_50019478)/sum(price)  as ratio_50019478,
sum(price_50019780)/sum(price)  as ratio_50019780,
sum(price_50020274)/sum(price)  as ratio_50020274,
sum(price_50020275)/sum(price)  as ratio_50020275,
sum(price_50020332)/sum(price)  as ratio_50020332,
sum(price_50020485)/sum(price)  as ratio_50020485,
sum(price_50020579)/sum(price)  as ratio_50020579,
sum(price_50020611)/sum(price)  as ratio_50020611,
sum(price_50020670)/sum(price)  as ratio_50020670,
sum(price_50020808)/sum(price)  as ratio_50020808,
sum(price_50020857)/sum(price)  as ratio_50020857,
sum(price_50022517)/sum(price)  as ratio_50022517,
sum(price_50022649)/sum(price)  as ratio_50022649,
sum(price_50022703)/sum(price)  as ratio_50022703,
sum(price_50022987)/sum(price)  as ratio_50022987,
sum(price_50023282)/sum(price)  as ratio_50023282,
sum(price_50023575)/sum(price)  as ratio_50023575,
sum(price_50023717)/sum(price)  as ratio_50023717,
sum(price_50023722)/sum(price)  as ratio_50023722,
sum(price_50023804)/sum(price)  as ratio_50023804,
sum(price_50024186)/sum(price)  as ratio_50024186,
sum(price_50024971)/sum(price)  as ratio_50024971,
sum(price_50025004)/sum(price)  as ratio_50025004,
sum(price_50025110)/sum(price)  as ratio_50025110,
sum(price_50025111)/sum(price)  as ratio_50025111,
sum(price_50025618)/sum(price)  as ratio_50025618,
sum(price_50025705)/sum(price)  as ratio_50025705,
sum(price_50025706)/sum(price)  as ratio_50025706,
sum(price_50025707)/sum(price)  as ratio_50025707,
sum(price_50025881)/sum(price)  as ratio_50025881,
sum(price_50025968)/sum(price)  as ratio_50025968,
sum(price_50026316)/sum(price)  as ratio_50026316,
sum(price_50026523)/sum(price)  as ratio_50026523,
sum(price_50026555)/sum(price)  as ratio_50026555,
sum(price_50026800)/sum(price)  as ratio_50026800,
sum(price_50050358)/sum(price)  as ratio_50050358,
sum(price_50050359)/sum(price)  as ratio_50050359,
sum(price_50050471)/sum(price)  as ratio_50050471,
sum(price_50074001)/sum(price)  as ratio_50074001,
sum(price_50158001)/sum(price)  as ratio_50158001,
sum(price_50454031)/sum(price)  as ratio_50454031,
sum(price_50468001)/sum(price)  as ratio_50468001,
sum(price_50488001)/sum(price)  as ratio_50488001,
sum(price_50510002)/sum(price)  as ratio_50510002,
sum(price_50802001)/sum(price)  as ratio_50802001,
sum(price_6666666 )/sum(price)  as ratio_6666666,
sum(price_7777777 )/sum(price)  as ratio_7777777,
sum(price_98      )/sum(price)  as ratio_98,
sum(price_99      )/sum(price)  as ratio_99

from
(
SELECT
user_id ,
price,
case when root_cat_id=11          then price else  0 end  as  price_11       ,
case when root_cat_id=1101        then price else  0 end  as  price_1101     ,
case when root_cat_id=1201        then price else  0 end  as  price_1201     ,
case when root_cat_id=120886001   then price else  0 end  as  price_12088600 ,
case when root_cat_id=121380001   then price else  0 end  as  price_12138000 ,
case when root_cat_id=121536003   then price else  0 end  as  price_12153600 ,
case when root_cat_id=121944003   then price else  0 end  as  price_12194400 ,
case when root_cat_id=122352003   then price else  0 end  as  price_12235200 ,
case when root_cat_id=122380005   then price else  0 end  as  price_12238000 ,
case when root_cat_id=122650005   then price else  0 end  as  price_12265000 ,
case when root_cat_id=122662002   then price else  0 end  as  price_12266200 ,
case when root_cat_id=122684003   then price else  0 end  as  price_12268400 ,
case when root_cat_id=122686003   then price else  0 end  as  price_12268600 ,
case when root_cat_id=122696005   then price else  0 end  as  price_12269600 ,
case when root_cat_id=122718004   then price else  0 end  as  price_12271800 ,
case when root_cat_id=122852001   then price else  0 end  as  price_12285200 ,
case when root_cat_id=122928002   then price else  0 end  as  price_12292800 ,
case when root_cat_id=122950001   then price else  0 end  as  price_12295000 ,
case when root_cat_id=122952001   then price else  0 end  as  price_12295200 ,
case when root_cat_id=122966004   then price else  0 end  as  price_12296600 ,
case when root_cat_id=123302001   then price else  0 end  as  price_12330200 ,
case when root_cat_id=123690003   then price else  0 end  as  price_12369000 ,
case when root_cat_id=124024001   then price else  0 end  as  price_12402400 ,
case when root_cat_id=124044001   then price else  0 end  as  price_12404400 ,
case when root_cat_id=124050001   then price else  0 end  as  price_12405000 ,
case when root_cat_id=124164002   then price else  0 end  as  price_12416400 ,
case when root_cat_id=124242008   then price else  0 end  as  price_12424200 ,
case when root_cat_id=124354002   then price else  0 end  as  price_12435400 ,
case when root_cat_id=124458005   then price else  0 end  as  price_12445800 ,
case when root_cat_id=124466001   then price else  0 end  as  price_12446600 ,
case when root_cat_id=124468001   then price else  0 end  as  price_12446800 ,
case when root_cat_id=124470006   then price else  0 end  as  price_12447000 ,
case when root_cat_id=124484008   then price else  0 end  as  price_12448400 ,
case when root_cat_id=124568010   then price else  0 end  as  price_12456801 ,
case when root_cat_id=124602001   then price else  0 end  as  price_12460200 ,
case when root_cat_id=124698018   then price else  0 end  as  price_12469801 ,
case when root_cat_id=124840002   then price else  0 end  as  price_12484000 ,
case when root_cat_id=124844002   then price else  0 end  as  price_12484400 ,
case when root_cat_id=124868003   then price else  0 end  as  price_12486800 ,
case when root_cat_id=14          then price else  0 end  as  price_14       ,
case when root_cat_id=1410        then price else  0 end  as  price_1410     ,
case when root_cat_id=1512        then price else  0 end  as  price_1512     ,
case when root_cat_id=16          then price else  0 end  as  price_16       ,
case when root_cat_id=1625        then price else  0 end  as  price_1625     ,
case when root_cat_id=1705        then price else  0 end  as  price_1705     ,
case when root_cat_id=1801        then price else  0 end  as  price_1801     ,
case when root_cat_id=20          then price else  0 end  as  price_20       ,
case when root_cat_id=21          then price else  0 end  as  price_21       ,
case when root_cat_id=2128        then price else  0 end  as  price_2128     ,
case when root_cat_id=23          then price else  0 end  as  price_23       ,
case when root_cat_id=25          then price else  0 end  as  price_25       ,
case when root_cat_id=26          then price else  0 end  as  price_26       ,
case when root_cat_id=27          then price else  0 end  as  price_27       ,
case when root_cat_id=28          then price else  0 end  as  price_28       ,
case when root_cat_id=2813        then price else  0 end  as  price_2813     ,
case when root_cat_id=29          then price else  0 end  as  price_29       ,
case when root_cat_id=30          then price else  0 end  as  price_30       ,
case when root_cat_id=3009        then price else  0 end  as  price_3009     ,
case when root_cat_id=33          then price else  0 end  as  price_33       ,
case when root_cat_id=34          then price else  0 end  as  price_34       ,
case when root_cat_id=35          then price else  0 end  as  price_35       ,
case when root_cat_id=40          then price else  0 end  as  price_40       ,
case when root_cat_id=50002766    then price else  0 end  as  price_50002766 ,
case when root_cat_id=50002768    then price else  0 end  as  price_50002768 ,
case when root_cat_id=50003754    then price else  0 end  as  price_50003754 ,
case when root_cat_id=50004958    then price else  0 end  as  price_50004958 ,
case when root_cat_id=50006842    then price else  0 end  as  price_50006842 ,
case when root_cat_id=50006843    then price else  0 end  as  price_50006843 ,
case when root_cat_id=50007216    then price else  0 end  as  price_50007216 ,
case when root_cat_id=50007218    then price else  0 end  as  price_50007218 ,
case when root_cat_id=50008075    then price else  0 end  as  price_50008075 ,
case when root_cat_id=50008090    then price else  0 end  as  price_50008090 ,
case when root_cat_id=50008097    then price else  0 end  as  price_50008097 ,
case when root_cat_id=50008141    then price else  0 end  as  price_50008141 ,
case when root_cat_id=50008163    then price else  0 end  as  price_50008163 ,
case when root_cat_id=50008164    then price else  0 end  as  price_50008164 ,
case when root_cat_id=50008165    then price else  0 end  as  price_50008165 ,
case when root_cat_id=50008168    then price else  0 end  as  price_50008168 ,
case when root_cat_id=50008171    then price else  0 end  as  price_50008171 ,
case when root_cat_id=50008825    then price else  0 end  as  price_50008825 ,
case when root_cat_id=50008907    then price else  0 end  as  price_50008907 ,
case when root_cat_id=50010388    then price else  0 end  as  price_50010388 ,
case when root_cat_id=50010404    then price else  0 end  as  price_50010404 ,
case when root_cat_id=50010728    then price else  0 end  as  price_50010728 ,
case when root_cat_id=50010788    then price else  0 end  as  price_50010788 ,
case when root_cat_id=50011397    then price else  0 end  as  price_50011397 ,
case when root_cat_id=50011665    then price else  0 end  as  price_50011665 ,
case when root_cat_id=50011699    then price else  0 end  as  price_50011699 ,
case when root_cat_id=50011740    then price else  0 end  as  price_50011740 ,
case when root_cat_id=50011949    then price else  0 end  as  price_50011949 ,
case when root_cat_id=50011972    then price else  0 end  as  price_50011972 ,
case when root_cat_id=50012029    then price else  0 end  as  price_50012029 ,
case when root_cat_id=50012082    then price else  0 end  as  price_50012082 ,
case when root_cat_id=50012100    then price else  0 end  as  price_50012100 ,
case when root_cat_id=50012164    then price else  0 end  as  price_50012164 ,
case when root_cat_id=50012472    then price else  0 end  as  price_50012472 ,
case when root_cat_id=50012769    then price else  0 end  as  price_50012769 ,
case when root_cat_id=50013864    then price else  0 end  as  price_50013864 ,
case when root_cat_id=50013886    then price else  0 end  as  price_50013886 ,
case when root_cat_id=50014442    then price else  0 end  as  price_50014442 ,
case when root_cat_id=50014476    then price else  0 end  as  price_50014476 ,
case when root_cat_id=50014811    then price else  0 end  as  price_50014811 ,
case when root_cat_id=50014812    then price else  0 end  as  price_50014812 ,
case when root_cat_id=50014927    then price else  0 end  as  price_50014927 ,
case when root_cat_id=50016348    then price else  0 end  as  price_50016348 ,
case when root_cat_id=50016349    then price else  0 end  as  price_50016349 ,
case when root_cat_id=50016422    then price else  0 end  as  price_50016422 ,
case when root_cat_id=50016768    then price else  0 end  as  price_50016768 ,
case when root_cat_id=50016891    then price else  0 end  as  price_50016891 ,
case when root_cat_id=50017133    then price else  0 end  as  price_50017133 ,
case when root_cat_id=50017300    then price else  0 end  as  price_50017300 ,
case when root_cat_id=50017652    then price else  0 end  as  price_50017652 ,
case when root_cat_id=50017673    then price else  0 end  as  price_50017673 ,
case when root_cat_id=50017708    then price else  0 end  as  price_50017708 ,
case when root_cat_id=50017908    then price else  0 end  as  price_50017908 ,
case when root_cat_id=50018004    then price else  0 end  as  price_50018004 ,
case when root_cat_id=50018222    then price else  0 end  as  price_50018222 ,
case when root_cat_id=50018252    then price else  0 end  as  price_50018252 ,
case when root_cat_id=50018264    then price else  0 end  as  price_50018264 ,
case when root_cat_id=50018719    then price else  0 end  as  price_50018719 ,
case when root_cat_id=50019095    then price else  0 end  as  price_50019095 ,
case when root_cat_id=50019478    then price else  0 end  as  price_50019478 ,
case when root_cat_id=50019780    then price else  0 end  as  price_50019780 ,
case when root_cat_id=50020274    then price else  0 end  as  price_50020274 ,
case when root_cat_id=50020275    then price else  0 end  as  price_50020275 ,
case when root_cat_id=50020332    then price else  0 end  as  price_50020332 ,
case when root_cat_id=50020485    then price else  0 end  as  price_50020485 ,
case when root_cat_id=50020579    then price else  0 end  as  price_50020579 ,
case when root_cat_id=50020611    then price else  0 end  as  price_50020611 ,
case when root_cat_id=50020670    then price else  0 end  as  price_50020670 ,
case when root_cat_id=50020808    then price else  0 end  as  price_50020808 ,
case when root_cat_id=50020857    then price else  0 end  as  price_50020857 ,
case when root_cat_id=50022517    then price else  0 end  as  price_50022517 ,
case when root_cat_id=50022649    then price else  0 end  as  price_50022649 ,
case when root_cat_id=50022703    then price else  0 end  as  price_50022703 ,
case when root_cat_id=50022987    then price else  0 end  as  price_50022987 ,
case when root_cat_id=50023282    then price else  0 end  as  price_50023282 ,
case when root_cat_id=50023575    then price else  0 end  as  price_50023575 ,
case when root_cat_id=50023717    then price else  0 end  as  price_50023717 ,
case when root_cat_id=50023722    then price else  0 end  as  price_50023722 ,
case when root_cat_id=50023804    then price else  0 end  as  price_50023804 ,
case when root_cat_id=50024186    then price else  0 end  as  price_50024186 ,
case when root_cat_id=50024971    then price else  0 end  as  price_50024971 ,
case when root_cat_id=50025004    then price else  0 end  as  price_50025004 ,
case when root_cat_id=50025110    then price else  0 end  as  price_50025110 ,
case when root_cat_id=50025111    then price else  0 end  as  price_50025111 ,
case when root_cat_id=50025618    then price else  0 end  as  price_50025618 ,
case when root_cat_id=50025705    then price else  0 end  as  price_50025705 ,
case when root_cat_id=50025706    then price else  0 end  as  price_50025706 ,
case when root_cat_id=50025707    then price else  0 end  as  price_50025707 ,
case when root_cat_id=50025881    then price else  0 end  as  price_50025881 ,
case when root_cat_id=50025968    then price else  0 end  as  price_50025968 ,
case when root_cat_id=50026316    then price else  0 end  as  price_50026316 ,
case when root_cat_id=50026523    then price else  0 end  as  price_50026523 ,
case when root_cat_id=50026555    then price else  0 end  as  price_50026555 ,
case when root_cat_id=50026800    then price else  0 end  as  price_50026800 ,
case when root_cat_id=50050358    then price else  0 end  as  price_50050358 ,
case when root_cat_id=50050359    then price else  0 end  as  price_50050359 ,
case when root_cat_id=50050471    then price else  0 end  as  price_50050471 ,
case when root_cat_id=50074001    then price else  0 end  as  price_50074001 ,
case when root_cat_id=50158001    then price else  0 end  as  price_50158001 ,
case when root_cat_id=50454031    then price else  0 end  as  price_50454031 ,
case when root_cat_id=50468001    then price else  0 end  as  price_50468001 ,
case when root_cat_id=50488001    then price else  0 end  as  price_50488001 ,
case when root_cat_id=50510002    then price else  0 end  as  price_50510002 ,
case when root_cat_id=50802001    then price else  0 end  as  price_50802001 ,
case when root_cat_id=6666666     then price else  0 end  as  price_6666666  ,
case when root_cat_id=7777777     then price else  0 end  as  price_7777777  ,
case when root_cat_id=98          then price else  0 end  as  price_98       ,
case when root_cat_id=99          then price else  0 end  as  price_99

from t_base_ec_record_dev_new_simple )
t group by user_id ;